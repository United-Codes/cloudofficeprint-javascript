# apexofficeprint-javascript
This project provides a JavaScript/TypeScript interface for APEX Office Print.

# Installation
To install the APEX Office Print Java-/TypeScript package, you can type in your terminal:  
`npm install apexofficeprint`

# Usage
1. Create a template (docx, xlsx, pptx, HTML, md, txt, csv), for the possible tags, click [here](http://www.apexofficeprint.com/docs/#templates).
2. Create the input data with this Java-/TypeScript SDK
3. Send template and data to an AOP server and save the response to a file with this Java-/TypeScript SDK

To see the JSON-data that is sent to the AOP server, you can turn on verbose-mode by setting the argument `aopVerbose` to `True` when creating a `PrintJob`.

# Quickstart: Hello World example
## Template (docx)
<img src="./imgs/hello_world_template.png" width="600" />
<!-- TODO: change this link to Github link -->

## Data
The data can be generated by the Java-/TypeScript SDK:
```javascript
import * as aop from 'apexofficeprint';

// Main object that holds the data
const collection = new aop.elements.ElementCollection();

// Create the title element and add it to the element collection
const title = new aop.elements.Property(
    'title',
    'Hello World!',
);
collection.add(title);

// Create the text element and add it to the element collection
const text = new aop.elements.Property(
    'text',
    'This is an example created with the AOP Java-/TypeScript SDK',
);
collection.add(text);
...
```

## AOP server
The template and the data need to be sent to an AOP server that merges both. This can be done by setting up the configuration for AOP server and passing it to the print job instance. You can get your API key by signing up at https://www.apexofficeprint.com.
```javascript
...
const SERVER_URL = 'https://api.apexofficeprint.com/';
const API_KEY = 'YOUR_API_KEY'; // Replace by your own API key

// Add server
const server = new aop.config.Server(
    SERVER_URL,
    new aop.config.ServerConfig(API_KEY),
);

// Create print job
const printjob = new aop.PrintJob(
    aop.Resource.fromLocalFile('PATH_TO_TEMPLATE_FILE'),
    collection,
    server,
);

// Asynchronously execute print job and save response to file
(async () => {
    const response = await printjob.execute();
    await response.toFile('PATH_OF_OUTPUT_FILE');
})();
```

## Result
<img src="./imgs/hello_world_output.png" width="600" />
<!-- TODO: change this link to Github link -->

# Other examples
Going through the other examples is also recommended as this gives you a good idea on how to use the SDK. The current examples are:
- order_confirmation_example.ts
- pdfsignature_example.ts
- solar_system_example.ts
- spacex_example.ts (the most extensive example)
- multiple_request_merge_example.ts

The examples can be found in the `examples`-directory of the project on [Github](https://github.com/United-Codes/apexofficeprint-javascript). Each example has its own folder containing the used templates, the generated output files and a markdown file with explanation when needed.

# Documentation
The documentation for this SDK can be found inside the `docs/` folder on [Github](https://github.com/United-Codes/apexofficeprint-javascript). If you want to generate this documentation yourself, you can run the following command in the project directory:  
`npx typedoc --out docs src/index.ts`

The full APEX Office Print documentation can be found at the [AOP docs](https://www.apexofficeprint.com/docs/).

# Tests 
To check if everything works, you can run the tests.

## Running the tests
1. Open a terminal in the parent directory of this project, which can be found on [Github](https://github.com/United-Codes/apexofficeprint-javascript).
2. Type in the terminal: `npm run test`

In the file `printjob.test.ts`, the test for the `executeFullJson()`-function is skipped because this test needs an API to succeed. You can enable this test by remove the `.skip` on the first line (as explained in the test file). The tests make use of the [jest](https://jestjs.io/)-package.

# ESLint
Airbnb style guide is used in this project with some tweaks (see .eslintrc.json).